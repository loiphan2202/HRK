# HRK - H·ªá th·ªëng Qu·∫£n l√Ω Nh√† h√†ng

## üìã M·ª•c ƒë√≠ch c·ªßa Project

HRK l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω nh√† h√†ng hi·ªán ƒë·∫°i ƒë∆∞·ª£c x√¢y d·ª±ng b·∫±ng Nodejs, Next.js v√† TypeORM, gi√∫p:

- **Qu·∫£n l√Ω menu v√† s·∫£n ph·∫©m**: Qu·∫£n tr·ªã vi√™n c√≥ th·ªÉ d·ªÖ d√†ng th√™m, s·ª≠a, x√≥a s·∫£n ph·∫©m v√† danh m·ª•c
- **Qu·∫£n l√Ω ƒë∆°n h√†ng**: Theo d√µi v√† x·ª≠ l√Ω ƒë∆°n h√†ng t·ª´ kh√°ch h√†ng m·ªôt c√°ch hi·ªáu qu·∫£
- **Qu·∫£n l√Ω b√†n ƒÉn**: Qu·∫£n l√Ω tr·∫°ng th√°i b√†n v√† t√≠ch h·ª£p QR code check-in
- **B√°o c√°o v√† th·ªëng k√™**: Xu·∫•t b√°o c√°o Excel v·ªõi ƒë·∫ßy ƒë·ªß th√¥ng tin doanh thu v√† s·∫£n ph·∫©m b√°n ch·∫°y
- **Tr·∫£i nghi·ªám kh√°ch h√†ng**: Giao di·ªán th√¢n thi·ªán, ƒë·∫∑t m√≥n d·ªÖ d√†ng, thanh to√°n ti·ªán l·ª£i

## ‚ú® Ch·ª©c nƒÉng c·ªßa Project

### üë®‚Äçüíº D√†nh cho Admin

#### 1. Qu·∫£n l√Ω S·∫£n ph·∫©m
- Th√™m, s·ª≠a, x√≥a s·∫£n ph·∫©m
- Upload h√¨nh ·∫£nh s·∫£n ph·∫©m
- G√°n nhi·ªÅu danh m·ª•c cho m·ªôt s·∫£n ph·∫©m
- Qu·∫£n l√Ω s·ªë l∆∞·ª£ng t·ªìn kho (stock)

#### 2. Qu·∫£n l√Ω Danh m·ª•c
- T·∫°o, s·ª≠a, x√≥a danh m·ª•c
- Ph√¢n lo·∫°i s·∫£n ph·∫©m theo danh m·ª•c

#### 3. Qu·∫£n l√Ω ƒê∆°n h√†ng
- Xem t·∫•t c·∫£ ƒë∆°n h√†ng v·ªõi b·ªô l·ªçc theo tr·∫°ng th√°i
- C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng (Ch·ªù x·ª≠ l√Ω, ƒêang x·ª≠ l√Ω, Ho√†n th√†nh, ƒê√£ h·ªßy)
- Xem chi ti·∫øt ƒë∆°n h√†ng (click v√†o m√£ ƒë∆°n)
- Xu·∫•t h√≥a ƒë∆°n PDF cho t·ª´ng ƒë∆°n h√†ng
- Xu·∫•t b√°o c√°o Excel theo tu·∫ßn/th√°ng/qu√Ω/nƒÉm
- Th·ªëng k√™ doanh thu v√† s·∫£n ph·∫©m b√°n ch·∫°y

#### 4. Qu·∫£n l√Ω B√†n ƒÉn
- T·∫°o v√† qu·∫£n l√Ω b√†n ƒÉn
- T·∫°o QR code cho t·ª´ng b√†n
- Theo d√µi tr·∫°ng th√°i b√†n (Tr·ªëng, ƒêang d√πng, ƒê√£ ƒë·∫∑t)
- Thanh to√°n v√† xu·∫•t h√≥a ƒë∆°n cho b√†n
- Ch·ªçn tr·∫°ng th√°i ƒë∆°n h√†ng khi thanh to√°n (X√°c nh·∫≠n thanh to√°n, ƒê√£ x·ª≠ l√Ω, ƒê√£ h·ªßy)

#### 5. Qu·∫£n l√Ω Ng∆∞·ªùi d√πng
- Xem danh s√°ch ng∆∞·ªùi d√πng
- Qu·∫£n l√Ω quy·ªÅn truy c·∫≠p (Admin/Customer)

### üë§ D√†nh cho Kh√°ch h√†ng

#### 1. Xem Menu
- Duy·ªát s·∫£n ph·∫©m theo danh m·ª•c
- T√¨m ki·∫øm s·∫£n ph·∫©m
- Xem chi ti·∫øt s·∫£n ph·∫©m

#### 2. ƒê·∫∑t m√≥n
- Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng
- Ch·ªçn b√†n ƒë·ªÉ ƒë·∫∑t m√≥n
- Check-in b·∫±ng QR code v√† t·ª± ƒë·ªông ch·ªçn b√†n
- Thanh to√°n v√† ƒë·∫∑t ƒë∆°n h√†ng

#### 3. Theo d√µi ƒë∆°n h√†ng
- Xem l·ªãch s·ª≠ ƒë∆°n h√†ng c·ªßa m√¨nh
- Theo d√µi tr·∫°ng th√°i ƒë∆°n h√†ng

## üõ†Ô∏è C√°c b∆∞·ªõc X√¢y d·ª±ng Project (Development Steps)

### B∆∞·ªõc 1: Kh·ªüi t·∫°o Next.js Project

T·∫°o project Next.js m·ªõi v·ªõi TypeScript:

```bash
npx create-next-app@latest hrk --typescript --tailwind --app --no-src-dir
cd hrk
```

---

### B∆∞·ªõc 2: C√†i ƒë·∫∑t Dependencies c∆° b·∫£n

C√†i ƒë·∫∑t c√°c package c·∫ßn thi·∫øt:

```bash
# Authentication & Security
npm install @types/bcrypt bcrypt
npm install @types/jsonwebtoken jsonwebtoken

# Database
npm install typeorm mongodb reflect-metadata

# QR Code
npm install qrcode @types/qrcode

# UI Components
npx shadcn@latest init
npx shadcn@latest add button card input label select table badge dialog toast checkbox alert-dialog dropdown-menu textarea
```

---

### B∆∞·ªõc 3: C·∫•u h√¨nh TypeORM

T·∫°o file `src/lib/typeorm.ts` ƒë·ªÉ c·∫•u h√¨nh k·∫øt n·ªëi database v·ªõi MongoDB:

```typescript
import { DataSource } from 'typeorm';
import 'reflect-metadata';
// Import c√°c entities...

export async function getDataSource(): Promise<DataSource> {
  // C·∫•u h√¨nh DataSource
}
```

---

### B∆∞·ªõc 4: T·∫°o Database Entities

T·∫°o c√°c entity cho database:

1. **User Entity** (`src/entities/User.ts`)
   - Th√¥ng tin ng∆∞·ªùi d√πng (email, password, role)
   - Ph√¢n quy·ªÅn Admin/Customer

2. **Category Entity** (`src/entities/Category.ts`)
   - Danh m·ª•c s·∫£n ph·∫©m

3. **Product Entity** (`src/entities/Product.ts`)
   - Th√¥ng tin s·∫£n ph·∫©m (name, price, stock, image)

4. **ProductCategory Entity** (`src/entities/ProductCategory.ts`)
   - Quan h·ªá many-to-many gi·ªØa Product v√† Category

5. **Table Entity** (`src/entities/Table.ts`)
   - Th√¥ng tin b√†n ƒÉn (number, status, token, qrCode)

6. **Order Entity** (`src/entities/Order.ts`)
   - Th√¥ng tin ƒë∆°n h√†ng (userId, tableId, total, status)

7. **OrderProduct Entity** (`src/entities/OrderProduct.ts`)
   - Chi ti·∫øt s·∫£n ph·∫©m trong ƒë∆°n h√†ng

---

### B∆∞·ªõc 5: T·∫°o Repository Layer

T·∫°o c√°c repository ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi database:

1. `BaseRepositoryTypeORM` - Repository c∆° s·ªü
2. `UserRepositoryTypeORM` - Qu·∫£n l√Ω users
3. `ProductRepositoryTypeORM` - Qu·∫£n l√Ω products v·ªõi quan h·ªá many-to-many
4. `CategoryRepositoryTypeORM` - Qu·∫£n l√Ω categories
5. `OrderRepositoryTypeORM` - Qu·∫£n l√Ω orders
6. `TableRepositoryTypeORM` - Qu·∫£n l√Ω tables

---

### B∆∞·ªõc 6: T·∫°o Service Layer

T·∫°o c√°c service ƒë·ªÉ x·ª≠ l√Ω business logic:

1. `UserServiceTypeORM` - Logic x·ª≠ l√Ω user (register, login, update)
2. `ProductServiceTypeORM` - Logic x·ª≠ l√Ω product (CRUD, update stock)
3. `CategoryServiceTypeORM` - Logic x·ª≠ l√Ω category
4. `OrderServiceTypeORM` - Logic x·ª≠ l√Ω order (create, update status, validate)
5. `TableServiceTypeORM` - Logic x·ª≠ l√Ω table (generate QR, check-in)
6. `OrderStatsServiceTypeORM` - Th·ªëng k√™ ƒë∆°n h√†ng

---

### B∆∞·ªõc 7: T·∫°o API Routes

T·∫°o c√°c API endpoints trong `src/app/api/`:

1. **Authentication APIs**
   - `POST /api/auth/register` - ƒêƒÉng k√Ω
   - `POST /api/auth/login` - ƒêƒÉng nh·∫≠p

2. **Product APIs**
   - `GET /api/products` - L·∫•y danh s√°ch s·∫£n ph·∫©m
   - `POST /api/products` - T·∫°o s·∫£n ph·∫©m m·ªõi
   - `PUT /api/products/[id]` - C·∫≠p nh·∫≠t s·∫£n ph·∫©m
   - `DELETE /api/products/[id]` - X√≥a s·∫£n ph·∫©m

3. **Category APIs**
   - `GET /api/categories` - L·∫•y danh s√°ch danh m·ª•c
   - `POST /api/categories` - T·∫°o danh m·ª•c m·ªõi
   - `PUT /api/categories/[id]` - C·∫≠p nh·∫≠t danh m·ª•c
   - `DELETE /api/categories/[id]` - X√≥a danh m·ª•c

4. **Order APIs**
   - `GET /api/orders` - L·∫•y danh s√°ch ƒë∆°n h√†ng
   - `POST /api/orders` - T·∫°o ƒë∆°n h√†ng m·ªõi
   - `PUT /api/orders/[id]` - C·∫≠p nh·∫≠t ƒë∆°n h√†ng
   - `GET /api/orders/stats` - Th·ªëng k√™ ƒë∆°n h√†ng

5. **Table APIs**
   - `GET /api/tables` - L·∫•y danh s√°ch b√†n
   - `POST /api/tables` - T·∫°o b√†n m·ªõi
   - `POST /api/tables/[id]/qr` - T·∫°o QR code cho b√†n
   - `POST /api/tables/check-in` - Check-in b·∫±ng token

---

### B∆∞·ªõc 8: T·∫°o UI Components

S·ª≠ d·ª•ng Shadcn UI ƒë·ªÉ t·∫°o c√°c components:

1. **Layout Components**
   - `MainNav` - Navigation bar v·ªõi authentication
   - `Footer` - Footer c·ªßa trang

2. **Product Components**
   - `ProductCard` - Card hi·ªÉn th·ªã s·∫£n ph·∫©m
   - `ProductList` - Danh s√°ch s·∫£n ph·∫©m v·ªõi filter
   - `CreateProduct` - Form t·∫°o s·∫£n ph·∫©m
   - `EditProduct` - Form ch·ªânh s·ª≠a s·∫£n ph·∫©m

3. **Order Components**
   - Cart context v√† components

4. **Admin Components**
   - Admin dashboard
   - Order management v·ªõi modal chi ti·∫øt
   - Table management v·ªõi QR code
   - Product management

---

### B∆∞·ªõc 9: T·∫°o Pages

T·∫°o c√°c trang cho ·ª©ng d·ª•ng:

**Customer Pages:**
1. `/` - Trang ch·ªß (danh s√°ch s·∫£n ph·∫©m)
2. `/[id]` - Chi ti·∫øt s·∫£n ph·∫©m
3. `/cart` - Gi·ªè h√†ng v√† checkout
4. `/check-in?token=...` - Check-in b√†n b·∫±ng QR code
5. `/login` - ƒêƒÉng nh·∫≠p
6. `/register` - ƒêƒÉng k√Ω

**Admin Pages:**
1. `/admin` - Dashboard admin
2. `/admin/products` - Qu·∫£n l√Ω s·∫£n ph·∫©m
3. `/admin/categories` - Qu·∫£n l√Ω danh m·ª•c
4. `/admin/orders` - Qu·∫£n l√Ω ƒë∆°n h√†ng
5. `/admin/tables` - Qu·∫£n l√Ω b√†n ƒÉn

---

### B∆∞·ªõc 10: Implement Authentication

1. T·∫°o `AuthContext` ƒë·ªÉ qu·∫£n l√Ω authentication state
2. T·∫°o middleware ƒë·ªÉ protect admin routes
3. Implement JWT token storage v√† validation
4. T·∫°o protected routes

---

### B∆∞·ªõc 11: Implement Cart Functionality

1. T·∫°o `CartContext` ƒë·ªÉ qu·∫£n l√Ω gi·ªè h√†ng
2. Implement add/remove/update cart items
3. T√≠ch h·ª£p v·ªõi localStorage ƒë·ªÉ l∆∞u cart
4. Checkout v·ªõi table selection v√† QR check-in

---

### B∆∞·ªõc 12: Implement QR Code Check-in

1. T·∫°o QR code generator service
2. Implement check-in API v·ªõi token validation
3. Auto-select table khi check-in th√†nh c√¥ng
4. L∆∞u check-in state trong localStorage

---

### B∆∞·ªõc 13: Implement Order Management

1. T·∫°o order v·ªõi validation
2. Update order status v·ªõi th·ªùi gian thanh to√°n
3. Order detail modal v·ªõi invoice export
4. Excel export v·ªõi statistics

---

### B∆∞·ªõc 14: Testing v√† Debugging

1. Test c√°c t√≠nh nƒÉng c∆° b·∫£n
2. Fix c√°c l·ªói TypeScript v√† ESLint
3. Test v·ªõi nhi·ªÅu scenarios
4. Optimize performance

---

## üöÄ C√°c b∆∞·ªõc ƒë·ªÉ Setup v√† Ch·∫°y Project

### B∆∞·ªõc 1: Clone Repository

```bash
git clone <repository-url>
cd hrk
```

---

### B∆∞·ªõc 2: C√†i ƒë·∫∑t Dependencies

M·ªü terminal v√† ch·∫°y l·ªánh:

```bash
npm install
```

---

### B∆∞·ªõc 3: C·∫•u h√¨nh Database

T·∫°o file `.env` trong th∆∞ m·ª•c g·ªëc v·ªõi n·ªôi dung:

```env
DATABASE_URL=mongodb://localhost:27017/hrk
JWT_SECRET=your-secret-key-here
NODE_ENV=development (t√πy ch·ªçn)
```

---

### B∆∞·ªõc 4: Ch·∫°y Project

Ch·∫°y l·ªánh ƒë·ªÉ kh·ªüi ƒë·ªông development server:

```bash
npm run dev
```

Truy c·∫≠p ·ª©ng d·ª•ng t·∫°i: `http://localhost:3000`

**Th√¥ng tin ƒëƒÉng nh·∫≠p admin m·∫∑c ƒë·ªãnh:**
- Email: `admin1@gmail.com`
- Password: `123456`

---

### B∆∞·ªõc 6: Build Production

ƒê·ªÉ build project cho production:

```bash
npm run build
```

---

## üì¶ C√¥ng ngh·ªá s·ª≠ d·ª•ng

- **Frontend**: Next.js 15, React, TypeScript
- **UI Components**: Shadcn UI, Tailwind CSS
- **Backend**: Next.js API Routes
- **Database**: MongoDB
- **ORM**: TypeORM
- **Authentication**: JWT
- **File Upload**: Next.js API v·ªõi multer

---

## üåê Deploy l√™n Heroku

### B∆∞·ªõc 1: C√†i ƒë·∫∑t Heroku CLI

T·∫£i v√† c√†i ƒë·∫∑t Heroku CLI t·ª´: https://devcenter.heroku.com/articles/heroku-cli

---

### B∆∞·ªõc 2: ƒêƒÉng nh·∫≠p Heroku

M·ªü terminal v√† ƒëƒÉng nh·∫≠p v√†o Heroku:

```bash
heroku login
```

---

### B∆∞·ªõc 3: T·∫°o Heroku App

T·∫°o m·ªôt ·ª©ng d·ª•ng m·ªõi tr√™n Heroku:

```bash
heroku create hrk
```

---

### B∆∞·ªõc 4: Th√™m MongoDB Atlas

1. Truy c·∫≠p MongoDB Atlas: https://www.mongodb.com/cloud/atlas
2. T·∫°o cluster m·ªõi
3. T·∫°o database user
4. Whitelist IP `0.0.0.0/0` ƒë·ªÉ cho ph√©p k·∫øt n·ªëi t·ª´ m·ªçi n∆°i
5. L·∫•y connection string

---

### B∆∞·ªõc 5: C·∫•u h√¨nh Environment Variables

Thi·∫øt l·∫≠p c√°c bi·∫øn m√¥i tr∆∞·ªùng tr√™n Heroku:

```bash
heroku config:set DATABASE_URL="your-mongodb-atlas-connection-string"
heroku config:set JWT_SECRET="your-random-secret-key"
```

**Ho·∫∑c th√¥ng qua Heroku Dashboard:**
1. V√†o Settings ‚Üí Config Vars
2. Th√™m `DATABASE_URL` v√† `JWT_SECRET`

---

### B∆∞·ªõc 6: Deploy Code l√™n Heroku

N·∫øu ƒë√£ c√≥ git repository:

```bash
git push heroku main
```

**N·∫øu ch∆∞a c√≥ git repository:**

```bash
git init
git add .
git commit -m "Initial commit"
heroku git:remote -a hrk
git push heroku main
```

---

### B∆∞·ªõc 7: Ki·ªÉm tra Deployment

Truy c·∫≠p ·ª©ng d·ª•ng t·∫°i:

```
https://your-app-name.herokuapp.com
```

---

### B∆∞·ªõc 8: Xem Logs (N·∫øu c√≥ l·ªói)

ƒê·ªÉ xem logs c·ªßa ·ª©ng d·ª•ng:

```bash
heroku logs --tail
```

---

## üìù Scripts c√≥ s·∫µn

- `npm run dev` - Ch·∫°y development server
- `npm run build` - Build production
- `npm run start` - Ch·∫°y production server
- `npm run lint` - Ki·ªÉm tra l·ªói linting

