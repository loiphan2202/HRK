module.exports=[631,a=>{"use strict";a.s(["default",()=>z],631);var b=a.i(87924),c=a.i(72131),d=a.i(63198),e=a.i(50944),f=a.i(15618),g=a.i(99570),h=a.i(14574),i=a.i(66718),j=a.i(70430),k=a.i(68114);function l({className:a,...c}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,k.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...c})}function m(){let[a,d]=(0,c.useState)(!1),[e,k]=(0,c.useState)(!1),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!1);async function q(){try{p(!0);let a=await fetch("/api/categories"),b=await a.json();b.success&&n(b.data||[])}catch(a){console.error("Failed to load categories:",a)}finally{p(!1)}}async function r(a){a.preventDefault();let b=a.currentTarget;k(!0);let c=new FormData(b);try{let a=await fetch("/api/products",{method:"POST",body:c,headers:{Accept:"application/json"}});if(!a.ok){let b=await a.json();throw console.error("Create error:",b),Error(b.message||"Failed to create product")}b.reset(),d(!1)}catch(a){console.error("Failed to create product:",a)}finally{k(!1)}}return(0,c.useEffect)(()=>{a&&q()},[a]),(0,b.jsxs)(h.Dialog,{open:a,onOpenChange:d,children:[(0,b.jsx)(h.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(g.Button,{children:[(0,b.jsx)(f.Plus,{className:"mr-2 h-4 w-4"}),"Add Product"]})}),(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Add Product"}),(0,b.jsx)(h.DialogDescription,{children:"Add a new product to your catalog. Click create when you're done."})]}),(0,b.jsxs)("form",{onSubmit:r,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"name",children:"Name"}),(0,b.jsx)(i.Input,{id:"name",name:"name",placeholder:"Product name",required:!0,disabled:e})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(l,{id:"description",name:"description",placeholder:"Product description",disabled:e})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"categoryId",children:"Category"}),o?(0,b.jsx)("div",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm items-center",children:"Loading categories..."}):(0,b.jsxs)("select",{id:"categoryId",name:"categoryId",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",required:!0,disabled:o||0===m.length,children:[(0,b.jsx)("option",{value:"",children:"Select a category"}),m.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"price",children:"Price"}),(0,b.jsx)(i.Input,{id:"price",name:"price",type:"number",step:"0.01",placeholder:"0.00",required:!0,disabled:e})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"stock",children:"Stock"}),(0,b.jsx)(i.Input,{id:"stock",name:"stock",type:"number",placeholder:"0",required:!0,disabled:e})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"image",children:"Image"}),(0,b.jsx)(i.Input,{id:"image",name:"image",type:"file",accept:"image/*",disabled:e})]})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:e,children:"Cancel"}),(0,b.jsx)(g.Button,{type:"submit",disabled:e,children:e?"Creating...":"Create"})]})]})]})]})}var n=a.i(71987),o=a.i(10448),p=a.i(17755);let q=(0,a.i(70106).default)("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var r=a.i(35732),s=a.i(6015),t=a.i(86192);function u({open:a,onOpenChange:d,product:e,onSuccess:f}){let[k,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1);async function r(){try{q(!0);let a=await fetch("/api/categories"),b=await a.json();b.success&&o(b.data||[])}catch(a){console.error("Failed to load categories:",a)}finally{q(!1)}}async function s(a){if(a.preventDefault(),!e)return;m(!0);let b=a.currentTarget,c=new FormData(b),g=b.querySelector('input[type="file"]');g&&g.files&&0===g.files.length&&c.delete("image");try{let a=await fetch(`/api/products/${e.id}`,{method:"PUT",body:c}),b=await a.json();if(!a.ok||!b.success){let a=b.error?.message||"Failed to update product";throw console.error("Update error:",b.error),Error(a)}f(),d(!1)}finally{m(!1)}}return(0,c.useEffect)(()=>{a&&r()},[a]),(0,b.jsx)(h.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Edit Product"}),(0,b.jsx)(h.DialogDescription,{children:"Make changes to your product here. Click save when you're done."})]}),(0,b.jsxs)("form",{onSubmit:s,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"name",children:"Name"}),(0,b.jsx)(i.Input,{id:"name",name:"name",defaultValue:e?.name,required:!0,disabled:k})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(l,{id:"description",name:"description",defaultValue:e?.description||"",disabled:k})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"categoryId",children:"Category"}),p?(0,b.jsx)("div",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm items-center",children:"Loading categories..."}):(0,b.jsxs)("select",{id:"categoryId",name:"categoryId",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",defaultValue:e?.categoryId||"",disabled:p||0===n.length,children:[(0,b.jsx)("option",{value:"",children:"Select a category"}),n.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"price",children:"Price"}),(0,b.jsx)(i.Input,{id:"price",name:"price",type:"number",step:"0.01",defaultValue:e?.price,required:!0,disabled:k})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"stock",children:"Stock"}),(0,b.jsx)(i.Input,{id:"stock",name:"stock",type:"number",defaultValue:e?.stock,required:!0,disabled:k})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(j.Label,{htmlFor:"image",children:"Image"}),(0,b.jsx)(i.Input,{id:"image",name:"image",type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",disabled:k})]})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:k,children:"Cancel"}),(0,b.jsx)(g.Button,{type:"submit",disabled:k,children:k?"Saving...":"Save changes"})]})]})]})})}async function v(){let a=await fetch("/api/products");return(await a.json()).data}function w(){let{isAdmin:a}=(0,d.useAuth)(),[e,f]=(0,c.useState)([]),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)({open:!1,productId:null}),[l,m]=(0,c.useState)({open:!1,product:null});async function w(){try{i(!0);let a=await v();f(a)}catch(a){console.error("Failed to load products:",a)}finally{i(!1)}}async function x(a){let b=[...e];f(e.filter(b=>b.id!==a));try{if(!(await fetch(`/api/products/${a}`,{method:"DELETE"})).ok)throw Error("Failed to delete product");k({open:!1,productId:null})}catch(a){f(b),console.error("Failed to delete product:",a)}}async function y(a){let b=[...e];f(e.map(b=>b.id===a.id?a:b));try{await w(),m({open:!1,product:null})}catch(a){f(b),console.error("Failed to update product:",a)}}return((0,c.useEffect)(()=>{w()},[]),h)?(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(s.Table,{children:[(0,b.jsx)(s.TableHeader,{children:(0,b.jsxs)(s.TableRow,{children:[(0,b.jsx)(s.TableHead,{className:"w-[100px]",children:"Image"}),(0,b.jsx)(s.TableHead,{children:"Name"}),(0,b.jsx)(s.TableHead,{children:"Description"}),(0,b.jsx)(s.TableHead,{className:"text-right",children:"Price"}),(0,b.jsx)(s.TableHead,{className:"text-right",children:"Stock"}),a()&&(0,b.jsx)(s.TableHead,{className:"text-right w-[100px]",children:"Actions"})]})}),(0,b.jsx)(s.TableBody,{children:Array.from({length:5}).map((c,d)=>(0,b.jsxs)(s.TableRow,{className:"animate-pulse",children:[(0,b.jsx)(s.TableCell,{children:(0,b.jsx)("div",{className:"h-10 w-10 rounded-md bg-muted"})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)("div",{className:"h-4 w-[200px] rounded bg-muted"})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)("div",{className:"h-4 w-[300px] rounded bg-muted"})}),(0,b.jsx)(s.TableCell,{className:"text-right",children:(0,b.jsx)("div",{className:"h-4 w-[60px] rounded bg-muted ml-auto"})}),(0,b.jsx)(s.TableCell,{className:"text-right",children:(0,b.jsx)("div",{className:"h-4 w-10 rounded bg-muted ml-auto"})}),a()&&(0,b.jsx)(s.TableCell,{children:(0,b.jsx)("div",{className:"h-8 w-[100px] rounded bg-muted ml-auto"})})]},`loading-${d}`))})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(s.Table,{children:[(0,b.jsx)(s.TableHeader,{children:(0,b.jsxs)(s.TableRow,{children:[(0,b.jsx)(s.TableHead,{className:"w-[100px]",children:"Image"}),(0,b.jsx)(s.TableHead,{children:"Name"}),(0,b.jsx)(s.TableHead,{children:"Description"}),(0,b.jsx)(s.TableHead,{className:"text-right",children:"Price"}),(0,b.jsx)(s.TableHead,{className:"text-right",children:"Stock"}),a()&&(0,b.jsx)(s.TableHead,{className:"text-right w-[100px]",children:"Actions"})]})}),(0,b.jsx)(s.TableBody,{children:0===e.length?(0,b.jsx)(s.TableRow,{children:(0,b.jsx)(s.TableCell,{colSpan:a()?6:5,className:"text-center text-muted-foreground",children:"No products found."})}):e.map(c=>(0,b.jsxs)(s.TableRow,{children:[(0,b.jsx)(s.TableCell,{children:c.image?(0,b.jsx)(n.default,{src:c.image,alt:c.name,width:40,height:40,className:"rounded-md object-cover"}):(0,b.jsx)("div",{className:"h-10 w-10 rounded-md bg-muted"})}),(0,b.jsx)(s.TableCell,{className:"font-medium",children:c.name}),(0,b.jsx)(s.TableCell,{className:"max-w-[300px] truncate",children:c.description}),(0,b.jsxs)(s.TableCell,{className:"text-right",children:["$",c.price.toFixed(2)]}),(0,b.jsx)(s.TableCell,{className:"text-right",children:c.stock}),a()&&(0,b.jsx)(s.TableCell,{className:"text-right",children:(0,b.jsxs)(r.DropdownMenu,{children:[(0,b.jsx)(r.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(g.Button,{variant:"ghost",size:"icon",children:[(0,b.jsx)(p.MoreHorizontal,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,b.jsxs)(r.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(r.DropdownMenuLabel,{children:"Actions"}),(0,b.jsxs)(r.DropdownMenuItem,{onClick:()=>m({open:!0,product:c}),children:[(0,b.jsx)(o.Edit2,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,b.jsxs)(r.DropdownMenuItem,{className:"text-red-600",onClick:()=>k({open:!0,productId:c.id}),children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},c.id))})]})}),(0,b.jsx)(t.AlertDialog,{open:j.open,onOpenChange:a=>k({open:a,productId:null}),children:(0,b.jsxs)(t.AlertDialogContent,{children:[(0,b.jsxs)(t.AlertDialogHeader,{children:[(0,b.jsx)(t.AlertDialogTitle,{children:"Are you sure?"}),(0,b.jsx)(t.AlertDialogDescription,{children:"This action cannot be undone. This will permanently delete the product."})]}),(0,b.jsxs)(t.AlertDialogFooter,{children:[(0,b.jsx)(t.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(t.AlertDialogAction,{className:"bg-red-600 text-red-50 hover:bg-red-700",onClick:()=>j.productId&&x(j.productId),children:"Delete"})]})]})}),(0,b.jsx)(u,{open:l.open,onOpenChange:a=>m({open:a,product:null}),product:l.product,onSuccess:()=>y(l.product)})]})}function x({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"skeleton",className:(0,k.cn)("bg-accent animate-pulse rounded-md",a),...c})}function y(){return(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(s.Table,{children:[(0,b.jsx)(s.TableHeader,{children:(0,b.jsxs)(s.TableRow,{children:[(0,b.jsx)(s.TableHead,{className:"w-[100px]",children:"Image"}),(0,b.jsx)(s.TableHead,{children:"Name"}),(0,b.jsx)(s.TableHead,{children:"Description"}),(0,b.jsx)(s.TableHead,{className:"text-right",children:"Price"}),(0,b.jsx)(s.TableHead,{className:"text-right",children:"Stock"}),(0,b.jsx)(s.TableHead,{className:"text-right w-[100px]",children:"Actions"})]})}),(0,b.jsx)(s.TableBody,{children:Array.from({length:5}).map((a,c)=>(0,b.jsxs)(s.TableRow,{children:[(0,b.jsx)(s.TableCell,{children:(0,b.jsx)(x,{className:"h-10 w-10"})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)(x,{className:"h-4 w-[200px]"})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)(x,{className:"h-4 w-[300px]"})}),(0,b.jsx)(s.TableCell,{className:"text-right",children:(0,b.jsx)(x,{className:"h-4 w-[60px] ml-auto"})}),(0,b.jsx)(s.TableCell,{className:"text-right",children:(0,b.jsx)(x,{className:"h-4 w-[40px] ml-auto"})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)(x,{className:"h-8 w-[100px] ml-auto"})})]},c))})]})})}function z(){let{isAdmin:a,isLoading:f}=(0,d.useAuth)(),g=(0,e.useRouter)();return((0,c.useEffect)(()=>{f||a()||g.push("/")},[f,a,g]),f||!a())?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})}):(0,b.jsxs)("div",{className:"flex flex-col space-y-8 w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"Products Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your product catalog, including inventory and pricing."})]}),(0,b.jsx)(m,{})]}),(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(y,{}),children:(0,b.jsx)(w,{})})]})}}];

//# sourceMappingURL=src_app_admin_products_page_tsx_eb8bba15._.js.map